<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Merch Checkout</title>
  <link rel="stylesheet" href="css/main.css" />
  <link rel="stylesheet" href="css/student.css" />
</head>
<body>

  <header class="navbar">
    <div class="brand">PAYFEES</div>
    <nav class="nav-links">
      <a href="student-dashboard.html">← Back to Dashboard</a>
    </nav>
  </header>

  <main class="dashboard-content">
    <h2 class="section-title">Merch Checkout</h2>

    <div class="checkout-container">
      <table class="fee-table">
        <thead>
          <tr>
            <th>Item</th>
            <th>Description</th>
            <th>Price</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="cartItems">
          <!-- Merch items dynamically added here -->
          <tr>
            <td>University Hoodie</td>
            <td>Comfortable and stylish</td>
            <td>₱950</td>
            <td><button class="remove-btn" onclick="removeItem(this)">Remove</button></td>
          </tr>
          <tr>
            <td>Campus Tumbler</td>
            <td>500ml stainless steel bottle</td>
            <td>₱300</td>
            <td><button class="remove-btn" onclick="removeItem(this)">Remove</button></td>
          </tr>
        </tbody>
      </table>

      <div class="total-section">
        <h3>Total: <span id="totalAmount">₱1250</span></h3>
        <button class="pay-btn" onclick="openCheckoutModal()">Proceed to Buy</button>
      </div>
    </div>
  </main>

  <!-- Payment Modal -->
  <div class="payment-modal" id="paymentModal">
    <div class="payment-content">
      <span class="close-btn" onclick="closeModal()">&times;</span>
      <h2>Confirm Purchase</h2>
      <form onsubmit="submitCheckout(event)">
        <label for="buyerName">Name:</label>
        <input type="text" id="buyerName" required />

        <label for="buyerEmail">Email:</label>
        <input type="email" id="buyerEmail" required />

        <label for="cardNumber">Card Number:</label>
        <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" required />

        <label for="expiry">Expiry Date:</label>
        <input type="text" id="expiry" placeholder="MM/YY" required />

        <label for="cvv">CVV:</label>
        <input type="text" id="cvv" placeholder="123" required />

        <button type="submit" class="pay-btn">Buy Now</button>
      </form>
    </div>
  </div>

  <script>
    function removeItem(button) {
      const row = button.closest("tr");
      row.remove();
      updateTotal();
    }

    function updateTotal() {
      let total = 0;
      const rows = document.querySelectorAll("#cartItems tr");
      rows.forEach(row => {
        const priceCell = row.children[2];
        const price = parseInt(priceCell.textContent.replace(/[₱,]/g, ''));
        total += price;
      });
      document.getElementById("totalAmount").textContent = `₱${total.toLocaleString()}`;
    }

    function openCheckoutModal() {
      document.getElementById("paymentModal").style.display = "flex";
    }

    function closeModal() {
      document.getElementById("paymentModal").style.display = "none";
    }

    function submitCheckout(event) {
      event.preventDefault();
      alert("✅ Purchase completed!");
      closeModal();
    }

    window.onclick = function (event) {
      const modal = document.getElementById("paymentModal");
      if (event.target === modal) closeModal();
    };

    let cart = [];

function addToCart(name, price) {
  const existing = cart.find(item => item.name === name);
  if (existing) {
    existing.qty++;
  } else {
    cart.push({ name, price, qty: 1 });
  }
  renderCart();
}

function renderCart() {
  const tbody = document.querySelector("#cartTable tbody");
  if (!tbody) return;
  
  tbody.innerHTML = "";

  cart.forEach((item, i) => {
    tbody.innerHTML += `
      <tr>
        <td>${item.name}</td>
        <td>₱${item.price}</td>
        <td>${item.qty}</td>
        <td>₱${item.price * item.qty}</td>
        <td><button onclick="removeItem(${i})">X</button></td>
      </tr>
    `;
  });
}

function removeItem(index) {
  cart.splice(index, 1);
  renderCart();
}


  </script>

</body>
</html>
